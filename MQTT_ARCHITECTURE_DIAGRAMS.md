# MQTT Architecture Diagram

## System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    HARIT SAMARTH IoT PLATFORM                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  DATA SOURCE LAYER                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ Field Sensorsâ”‚ Sensor Gen.  â”‚ Manual Entry â”‚ External APIsâ”‚     â”‚
â”‚  â”‚ (Physical)  â”‚ (Simulated)  â”‚ (Dashboard)  â”‚ (Weather)    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚         â”‚               â”‚               â”‚               â”‚           â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                         â†“                                            â”‚
â”‚  MESSAGING LAYER                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚         MQTT SENSOR PUBLISHER                           â”‚       â”‚
â”‚  â”‚  mqtt_sensor_publisher.py / sensor_generator.py        â”‚       â”‚
â”‚  â”‚                                                          â”‚       â”‚
â”‚  â”‚  âœ“ Generates realistic readings                         â”‚       â”‚
â”‚  â”‚  âœ“ Loads historical data on startup                    â”‚       â”‚
â”‚  â”‚  âœ“ Publishes to MQTT every 60 seconds                 â”‚       â”‚
â”‚  â”‚  âœ“ Handles connection failures gracefully               â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚         â”‚                                                            â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚                            â†“                                    â”‚    â”‚
â”‚  BROKER LAYER                                                  â”‚    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚    â”‚
â”‚  â”‚     MQTT BROKER (Mosquitto / EMQX / HiveMQ)       â”‚      â”‚    â”‚
â”‚  â”‚                                                     â”‚      â”‚    â”‚
â”‚  â”‚  Topics:                                            â”‚      â”‚    â”‚
â”‚  â”‚  â”œâ”€ harit-samarth/sensor/data (Primary)           â”‚      â”‚    â”‚
â”‚  â”‚  â”œâ”€ harit-samarth/soil-health/analysis            â”‚      â”‚    â”‚
â”‚  â”‚  â””â”€ harit-samarth/status                          â”‚      â”‚    â”‚
â”‚  â”‚                                                     â”‚      â”‚    â”‚
â”‚  â”‚  Features:                                          â”‚      â”‚    â”‚
â”‚  â”‚  âœ“ QoS 1 (At-least-once delivery)                â”‚      â”‚    â”‚
â”‚  â”‚  âœ“ Message persistence (optional)                 â”‚      â”‚    â”‚
â”‚  â”‚  âœ“ Multi-subscriber support                       â”‚      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚    â”‚
â”‚         â”‚                                                      â”‚    â”‚
â”‚         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”  â”‚
â”‚         â†“                  â†“                  â†“                  â”‚  â”‚
â”‚  PROCESSING LAYER                                              â”‚  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  MQTT SUBSCRIBER â”‚  â”‚   MQTT Monitoringâ”‚  â”‚   MQTT Toolsâ”‚  â”‚  â”‚
â”‚  â”‚  (Backend)       â”‚  â”‚   Dashboard      â”‚  â”‚   (mqtt_sub) â”‚  â”‚  â”‚
â”‚  â”‚                  â”‚  â”‚                  â”‚  â”‚              â”‚  â”‚  â”‚
â”‚  â”‚ mqtt_sensor_sub. â”‚  â”‚ MQTT.fx / Box    â”‚  â”‚ CLI Monitor  â”‚  â”‚  â”‚
â”‚  â”‚ scriber.py       â”‚  â”‚ (Optional)       â”‚  â”‚ (Debugging)  â”‚  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚         â”‚                                                      â”‚  â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â†“                                       â”‚
â”‚  API LAYER                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚              FLASK BACKEND API (app.py)                 â”‚     â”‚
â”‚  â”‚                                                          â”‚     â”‚
â”‚  â”‚  Endpoints:                                              â”‚     â”‚
â”‚  â”‚  POST   /api/soil-health/analyze                        â”‚     â”‚
â”‚  â”‚  GET    /api/soil-health/latest                         â”‚     â”‚
â”‚  â”‚  GET    /api/soil-health/history                        â”‚     â”‚
â”‚  â”‚  GET    /api/soil-health/stats                          â”‚     â”‚
â”‚  â”‚  POST   /api/crops/recommendations                      â”‚     â”‚
â”‚  â”‚  GET    /api/crops/details/<slug>                       â”‚     â”‚
â”‚  â”‚                                                          â”‚     â”‚
â”‚  â”‚  Functions:                                              â”‚     â”‚
â”‚  â”‚  âœ“ Analyzes soil health (health_index, status)         â”‚     â”‚
â”‚  â”‚  âœ“ Detects anomalies                                   â”‚     â”‚
â”‚  â”‚  âœ“ Stores to MySQL + CSV                               â”‚     â”‚
â”‚  â”‚  âœ“ Generates crop recommendations                      â”‚     â”‚
â”‚  â”‚  âœ“ Integrates weather data                             â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚         â”‚                                                          â”‚
â”‚         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚         â†“                 â†“                                   â†“   â”‚
â”‚  STORAGE LAYER                                               â”‚   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚     MySQL        â”‚  â”‚   CSV Files      â”‚  â”‚  JSON Logs â”‚ â”‚   â”‚
â”‚  â”‚  Database        â”‚  â”‚   (Backup)       â”‚  â”‚ (Audit)    â”‚ â”‚   â”‚
â”‚  â”‚                  â”‚  â”‚                  â”‚  â”‚            â”‚ â”‚   â”‚
â”‚  â”‚ sensor_readings  â”‚  â”‚ sensor_readings  â”‚  â”‚ mqtt_*.log â”‚ â”‚   â”‚
â”‚  â”‚ analysis_history â”‚  â”‚ mqtt_received    â”‚  â”‚            â”‚ â”‚   â”‚
â”‚  â”‚                  â”‚  â”‚                  â”‚  â”‚            â”‚ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚         â”‚                  â”‚                       â”‚         â”‚   â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚   â”‚
â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”˜   â”‚
â”‚                                                             â†“     â”‚
â”‚  FRONTEND LAYER                                             â”‚     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚     â”‚
â”‚  â”‚        SENSOR MONITORING DASHBOARD                  â”‚   â”‚     â”‚
â”‚  â”‚  src/components/SensorMonitoring.tsx                â”‚   â”‚     â”‚
â”‚  â”‚                                                      â”‚   â”‚     â”‚
â”‚  â”‚  Features:                                           â”‚   â”‚     â”‚
â”‚  â”‚  âœ“ NPK Nutrients Line Chart                         â”‚   â”‚     â”‚
â”‚  â”‚  âœ“ Environmental Conditions Area Chart              â”‚   â”‚     â”‚
â”‚  â”‚  âœ“ Soil Health Metrics Bar Chart                    â”‚   â”‚     â”‚
â”‚  â”‚  âœ“ Latest Reading Card with Health Status           â”‚   â”‚     â”‚
â”‚  â”‚  âœ“ Recent Readings Table                            â”‚   â”‚     â”‚
â”‚  â”‚  âœ“ Anomaly Detection Alerts                         â”‚   â”‚     â”‚
â”‚  â”‚  âœ“ CSV/JSON Export Buttons                          â”‚   â”‚     â”‚
â”‚  â”‚  âœ“ Real-time Data Statistics                        â”‚   â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚     â”‚
â”‚                         â†“                                    â”‚     â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚     â”‚
â”‚                  â”‚ User Browserâ”‚                             â”‚     â”‚
â”‚                  â”‚ Dashboard   â”‚                             â”‚     â”‚
â”‚                  â”‚ Visualization                             â”‚     â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚     â”‚
â”‚                                                              â”‚     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
                   â†“ Optional Fallback                             
           (If MQTT unavailable)
           
           Publisher â†’ Direct API â†’ Flask â†’ Database
           (API-Only Mode)
```

---

## Data Flow Sequence

```
TIME 0:00 - SYSTEM STARTUP
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Publisher              Broker              Subscriber          API
   â”‚                    â”‚                      â”‚                 â”‚
   â”œâ”€ Load History â”€â”€â”                        â”‚                 â”‚
   â”‚                 â””â”€â†’ Get Latest Data from MySQL          
   â”‚                                           â”‚                 â”‚
   â”œâ”€ Connect to Broker â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚                 â”‚
   â”‚                                      â””â”€â”€â†’ ACK              â”‚
   â”‚                    â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
   â”‚ (Connected)                           â”‚                 â”‚
   â”‚                                        â”‚                 â”‚


TIME 0:00 - FIRST SENSOR READING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Publisher              Broker              Subscriber          API
   â”‚                    â”‚                      â”‚                 â”‚
   â”œâ”€ Generate Reading â”€â”
   â”‚  {N:22.5, P:17.8}  â”‚
   â”‚                    â”‚
   â”œâ”€ Create Message â”€â”€â”€â”¤
   â”‚ {timestamp, data}  â”‚
   â”‚                    â”‚
   â”œâ”€ Publish to MQTT â”€â”€â”¤
   â”‚    (QoS=1)         â”‚
   â”‚                    â”œâ”€ Store in Queue     â”‚                 â”‚
   â”‚                    â”‚                    â”‚                 â”‚
   â”‚                    â”œâ”€ Forward to Sub â”€â”€â”€â†’â”‚                 â”‚
   â”‚                    â”‚                    â”‚ Receive         â”‚
   â”‚                    â”‚                    â”œâ”€ Parse JSON    â”‚
   â”‚                    â”‚                    â”œâ”€ Validate      â”‚
   â”‚                    â”‚                    â”œâ”€ Forward API â”€â”€â†’â”‚
   â”‚                    â”‚                    â”‚                 â”‚
   â”‚                    â”‚                    â”‚             Analyze
   â”‚                    â”‚                    â”‚             Health
   â”‚                    â”‚                    â”‚             Index
   â”‚                    â”‚                    â”‚
   â”‚                    â”‚                    â”‚â†â”€ Response OK â”€â”¤
   â”‚                    â”‚                    â”‚                 â”‚
   â”‚                    â”‚                    â”œâ”€ Log CSV       â”‚
   â”‚                    â”‚                    â”‚                 â”‚
   â”‚â—„â”€â”€â”€â”€ ACK (QoS=1) â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
   â”‚ (Message Delivered)â”‚                                      â”‚
   â”‚                    â”‚                                      â”‚


TIME 0:10 - FRONTEND POLLS DATA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

                                            API             Database
                                             â”‚                 â”‚
                                     Frontend â”‚                 â”‚
                                       â”œâ”€ Poll API â”€â”€â”€â”€â”€â”€â”€â†’ â”‚
                                       â”‚                    â”‚
                                       â”‚                  Query
                                       â”‚                  Latest
                                       â”‚                  100
                                       â”‚                  Readings
                                       â”‚                    â”‚
                                       â”‚ â—„â”€ Response OK â”€â”€â†’ â”‚
                                       â”‚  Latest Data      â”‚
                                       â”‚                    â”‚
                                       â”œâ”€ Render Charts    â”‚
                                       â”œâ”€ Update Stats     â”‚
                                       â”œâ”€ Display Status   â”‚
                                       â”‚                    â”‚
                                    [User Views Dashboard]


TIME 1:00 - NEXT SENSOR READING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Publisher              Broker              Subscriber          API
   â”‚                    â”‚                      â”‚                 â”‚
   â”œâ”€ Generate Reading â”€â”
   â”‚  (continues...)    â”‚
   â”‚ (Cycle repeats)    â”‚
   â”‚                    â”‚
   â””â”€ (Every 60 sec)    â”‚
```

---

## Component Interaction Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DATA GENERATION                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  PHYSICAL SENSORS          SIMULATED DATA GENERATOR            â”‚
â”‚     (Real IoT)             (Development/Testing)               â”‚
â”‚         â”‚                          â”‚                            â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                        â”‚                                        â”‚
â”‚                 Sensor Readings                                â”‚
â”‚           {N, P, K, CO2, Temp, etc}                           â”‚
â”‚                        â”‚                                        â”‚
â”‚                        â†“                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MESSAGE PUBLISHING                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚    MQTT SENSOR PUBLISHER (mqtt_sensor_publisher.py)           â”‚
â”‚                                                                  â”‚
â”‚    Responsibilities:                                            â”‚
â”‚    â€¢ Generate realistic sensor variations                       â”‚
â”‚    â€¢ Load historical data for continuity                       â”‚
â”‚    â€¢ Format JSON messages with timestamps                      â”‚
â”‚    â€¢ Publish to MQTT broker with QoS=1                        â”‚
â”‚    â€¢ Handle connection failures and retry                      â”‚
â”‚                                                                  â”‚
â”‚    Can also be replaced by:                                    â”‚
â”‚    â€¢ sensor_generator.py (with USE_MQTT=True)                 â”‚
â”‚    â€¢ Real hardware sensor MQTT client                         â”‚
â”‚    â€¢ IoT gateway (Raspberry Pi, Arduino, etc)                 â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MESSAGE BROKERING                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚         MQTT BROKER (Mosquitto/EMQX/HiveMQ)                   â”‚
â”‚                                                                  â”‚
â”‚    Responsibilities:                                            â”‚
â”‚    â€¢ Accept connections from publishers                        â”‚
â”‚    â€¢ Route messages to subscribers                             â”‚
â”‚    â€¢ Guarantee QoS (Quality of Service)                       â”‚
â”‚    â€¢ Manage subscriptions and topics                           â”‚
â”‚    â€¢ Handle client authentication                              â”‚
â”‚    â€¢ Persist messages (optional)                               â”‚
â”‚    â€¢ Bridge to other brokers (clustering)                      â”‚
â”‚                                                                  â”‚
â”‚    Message Format:                                              â”‚
â”‚    Topic: harit-samarth/sensor/data                            â”‚
â”‚    Payload: {timestamp, publisher_id, sensor_readings}        â”‚
â”‚    QoS: 1 (At least once)                                     â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MESSAGE CONSUMPTION                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚    MQTT SENSOR SUBSCRIBER (mqtt_sensor_subscriber.py)         â”‚
â”‚                                                                  â”‚
â”‚    Responsibilities:                                            â”‚
â”‚    â€¢ Subscribe to MQTT topics                                  â”‚
â”‚    â€¢ Receive published messages                                â”‚
â”‚    â€¢ Parse and validate sensor data                            â”‚
â”‚    â€¢ Forward to Flask API for processing                      â”‚
â”‚    â€¢ Handle API responses                                      â”‚
â”‚    â€¢ Log to CSV for audit trail                               â”‚
â”‚    â€¢ Monitor connection health                                 â”‚
â”‚    â€¢ Support multiple publishers                               â”‚
â”‚                                                                  â”‚
â”‚    Can scale to:                                               â”‚
â”‚    â€¢ Multiple subscriber instances                             â”‚
â”‚    â€¢ Load balanced message processing                          â”‚
â”‚    â€¢ High-throughput data pipelines                           â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DATA PROCESSING                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚         FLASK BACKEND API (app.py)                            â”‚
â”‚                                                                  â”‚
â”‚    POST /api/soil-health/analyze                              â”‚
â”‚                                                                  â”‚
â”‚    Process: Sensor Readings â†’ Health Analysis                 â”‚
â”‚                                                                  â”‚
â”‚    â”Œâ”€ Receive sensor data from subscriber â”€â”                  â”‚
â”‚    â”‚                                        â†“                  â”‚
â”‚    â”‚    calculate_health_index()            â”‚                  â”‚
â”‚    â”‚    â”œâ”€ Scores: 1-100 (Excellent/Good/Fair/Poor/Critical) â”‚
â”‚    â”‚    â””â”€ Based on: N,P,K,CO2,Temp,Moisture,pH ranges       â”‚
â”‚    â”‚                                        â”‚                  â”‚
â”‚    â”‚    detect_anomalies()                  â”‚                  â”‚
â”‚    â”‚    â”œâ”€ Checks for out-of-range values   â”‚                  â”‚
â”‚    â”‚    â””â”€ Calculates anomaly severity score â”‚                  â”‚
â”‚    â”‚                                        â”‚                  â”‚
â”‚    â”‚    identify_critical_factors()         â”‚                  â”‚
â”‚    â”‚    â””â”€ Lists parameters needing attention                 â”‚
â”‚    â”‚                                        â”‚                  â”‚
â”‚    â”‚    save_to_mysql()                     â”‚                  â”‚
â”‚    â”‚    â””â”€ Stores to sensor_readings table  â”‚                  â”‚
â”‚    â”‚                                        â”‚                  â”‚
â”‚    â”‚    save_to_csv()                       â”‚                  â”‚
â”‚    â”‚    â””â”€ Backup to sensor_readings.csv    â”‚                  â”‚
â”‚    â”‚                                        â†“                  â”‚
â”‚    â””â”€ Return analysis response â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                                  â”‚
â”‚    Response:                                                    â”‚
â”‚    {                                                            â”‚
â”‚      timestamp, soil_health_index, health_status,             â”‚
â”‚      is_anomalous, anomaly_score, critical_factors,           â”‚
â”‚      sensor_readings                                            â”‚
â”‚    }                                                            â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DATA STORAGE                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  MYSQL DATABASE              CSV FILES           JSON LOGS     â”‚
â”‚  (Primary Storage)           (Backup)            (Audit Trail)  â”‚
â”‚                                                                  â”‚
â”‚  sensor_readings             sensor_readings.csv mqtt_*.log    â”‚
â”‚  â”œâ”€ id (PK)                  â”œâ”€ timestamp        â”œâ”€ timestamp   â”‚
â”‚  â”œâ”€ timestamp (indexed)       â”œâ”€ N, P, K          â”œâ”€ message    â”‚
â”‚  â”œâ”€ N, P, K, CO2             â”œâ”€ Temperature      â”œâ”€ publisher_idâ”‚
â”‚  â”œâ”€ temperature              â”œâ”€ Moisture          â”œâ”€ status      â”‚
â”‚  â”œâ”€ moisture                 â”œâ”€ pH               â””â”€ ...         â”‚
â”‚  â”œâ”€ pH                       â”œâ”€ health_index                    â”‚
â”‚  â”œâ”€ health_index             â”œâ”€ health_status                   â”‚
â”‚  â”œâ”€ health_status            â””â”€ ...                             â”‚
â”‚  â”œâ”€ is_anomalous                                               â”‚
â”‚  â”œâ”€ anomaly_score            mqtt_sensor_received.csv         â”‚
â”‚  â””â”€ critical_factors         â””â”€ (mirror of MQTT messages)      â”‚
â”‚                                                                  â”‚
â”‚  analysis_history                                               â”‚
â”‚  â”œâ”€ id (PK)                                                     â”‚
â”‚  â”œâ”€ sensor_id (FK)                                              â”‚
â”‚  â”œâ”€ analyzed_at                                                 â”‚
â”‚  â””â”€ analysis_result (JSON)                                      â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DATA VISUALIZATION                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚    FRONTEND DASHBOARD (SensorMonitoring.tsx)                  â”‚
â”‚                                                                  â”‚
â”‚    Polling: GET /api/soil-health/history (every 10 seconds)   â”‚
â”‚                                                                  â”‚
â”‚    Displays:                                                    â”‚
â”‚    â€¢ 4 Interactive Charts (Recharts library)                  â”‚
â”‚      â”œâ”€ NPK Nutrients Line Chart                              â”‚
â”‚      â”œâ”€ Environmental Conditions Area Chart                    â”‚
â”‚      â”œâ”€ Soil Health Metrics Bar Chart                         â”‚
â”‚      â””â”€ pH & Health Index Bar Chart                           â”‚
â”‚                                                                  â”‚
â”‚    â€¢ Latest Reading Card                                       â”‚
â”‚      â”œâ”€ Health Status Badge (color-coded)                     â”‚
â”‚      â”œâ”€ Key Metrics (Index, Temp, Moisture, pH)              â”‚
â”‚      â””â”€ Anomaly Alert (if detected)                          â”‚
â”‚                                                                  â”‚
â”‚    â€¢ Recent Readings Table                                     â”‚
â”‚      â””â”€ Last 10 measurements with details                      â”‚
â”‚                                                                  â”‚
â”‚    â€¢ Export Buttons                                            â”‚
â”‚      â”œâ”€ CSV Export (comma-separated values)                   â”‚
â”‚      â””â”€ JSON Export (for analysis)                            â”‚
â”‚                                                                  â”‚
â”‚    â€¢ Statistics Summary                                        â”‚
â”‚      â”œâ”€ Total Readings Count                                  â”‚
â”‚      â”œâ”€ Average Health Index                                   â”‚
â”‚      â”œâ”€ Anomalies Detected                                    â”‚
â”‚      â””â”€ Anomaly Percentage                                    â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Fallback & Error Handling

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           MQTT AVAILABILITY CHECK                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚  Publisher Startup                                        â”‚
â”‚         â”‚                                                  â”‚
â”‚         â”œâ”€ Try to connect to MQTT broker                 â”‚
â”‚         â”‚   Retries: 3 attempts                          â”‚
â”‚         â”‚   Timeout: 5 seconds each                      â”‚
â”‚         â”‚                                                  â”‚
â”‚         â”œâ”€ Success? â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚         â”‚                  â”‚                              â”‚
â”‚         â”œâ”€ Yes             â””â”€â”€â†’ âœ“ MQTT Mode              â”‚
â”‚         â”‚   SET: use_mqtt = True                         â”‚
â”‚         â”‚   Publish via MQTT                             â”‚
â”‚         â”‚                                                  â”‚
â”‚         â””â”€ No              â”Œâ”€â”€â†’ âš  API Fallback Mode     â”‚
â”‚            SET: use_mqtt = False                         â”‚
â”‚            Use direct API calls                          â”‚
â”‚                                                            â”‚
â”‚                                                            â”‚
â”‚  During Operation                                         â”‚
â”‚         â”‚                                                  â”‚
â”‚         â”œâ”€ MQTT connected? â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚         â”‚                         â”‚                      â”‚
â”‚         â”œâ”€ Yes                    â””â”€â”€â†’ âœ“ Send via MQTT  â”‚
â”‚         â”‚                             (Subscriber)       â”‚
â”‚         â”‚                                                  â”‚
â”‚         â””â”€ No                    â”Œâ”€â”€â†’ âš  Direct API      â”‚
â”‚            Connection Lost         â”‚    (Fallback)       â”‚
â”‚            Fall back to API        â”‚                      â”‚
â”‚                                                            â”‚
â”‚                                                            â”‚
â”‚  Data Never Lost                                          â”‚
â”‚         â”‚                                                  â”‚
â”‚         â”œâ”€ MQTT Mode: Data sent via broker               â”‚
â”‚         â”‚  â””â”€ Subscriber receives and saves to DB        â”‚
â”‚         â”‚                                                  â”‚
â”‚         â”œâ”€ API Mode: Direct to API                       â”‚
â”‚         â”‚  â””â”€ API saves to DB                            â”‚
â”‚         â”‚                                                  â”‚
â”‚         â””â”€ CSV Backup: Always saved locally              â”‚
â”‚            â””â”€ Persists even if DB unavailable           â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Scaling Architecture

```
Development (Current)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                                                            
  1 Publisher â”€â”€â”                                          
                â”‚â”€â”€ MQTT Broker â”€â”€â”â”€â”€ 1 Subscriber        
  Simulator     â”‚                 â”‚                        
                â””                 â””â”€â”€ API â†’ MySQL + CSV    
                                                            
  Throughput: ~1 msg/60 sec = 1,440 msgs/day               
  Latency: <100ms                                           


Scale Out (Multiple Sites)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                                                             
  Publisher 1 â”€â”€â”                                           
  Publisher 2 â”€â”€â”¼â”€â”€ MQTT Broker â”€â”€â”â”€â”€ Subscriber 1         
  ...           â”‚                 â”œâ”€â”€ Subscriber 2         
  Publisher N â”€â”€â”˜                 â”‚â”€â”€ ...                  
                                  â””â”€â”€ MQTT CLI Monitor      
                                                             
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ API â†’ MySQL Cluster â† Replicas      
                                  â†“                         
                            Time-Series DB                 
                            (InfluxDB/TimescaleDB)          
                                  â†“                         
                            Analytics Engine               
                            (Real-time dashboards)         


Scale Up (High Throughput)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                                                              
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   
  â”‚ Multi-Broker Cluster                â”‚                   
  â”‚ (EMQX Enterprise / AWS IoT Core)    â”‚                   
  â”‚ â”œâ”€ Geographic Distribution           â”‚                   
  â”‚ â”œâ”€ Load Balancing                    â”‚                   
  â”‚ â”œâ”€ Message Persistence               â”‚                   
  â”‚ â””â”€ High Availability                 â”‚                   
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   
             â”‚                                               
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 
    â†“        â†“            â†“                                 
  Stream   Real-Time   Historical                          
  Processor Analytics   Archive                             
   (Kafka)  (Flink)    (S3/GCS)                             
```

---

This visual architecture shows how all components interact to create a scalable, reliable IoT platform for agricultural monitoring! ğŸŒ¾ğŸ“Š
